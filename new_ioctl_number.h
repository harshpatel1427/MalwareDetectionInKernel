/*
* This file contains declaration of new ioctl
* functions required for addind, removing and
* listing patterns. It also defines structure
* for passing patterns to the kernel.
*/

#ifndef IOCTL_PATTERN
#define IOCTL_PATTERN

#include <linux/ioctl.h>

/* defines ioctl magic number */
#define IOC_MAGIC ']'

/* define ioctl methods */
#define IOCTL_PATTERN_READ _IOR(IOC_MAGIC, 0, char *)
#define IOCTL_PATTERN_ADD _IOW(IOC_MAGIC, 1, struct argument *)
#define IOCTL_PATTERN_REMOVE _IOW(IOC_MAGIC, 2, struct argument *)
#define IOCTL_PATTERN_LENGTH_COUNT _IOR(IOC_MAGIC, 3, int)

/* defines structure for passing patterns */
struct argument {
	char *pattern;
	int length;
};

#endif
